<!DOCTYPE html>
<html>
<head>
<title>Introduction to Smart Contracts.md</title>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8">

<style>
/* https://github.com/microsoft/vscode/blob/master/extensions/markdown-language-features/media/markdown.css */
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

body {
	font-family: var(--vscode-markdown-font-family, -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif);
	font-size: var(--vscode-markdown-font-size, 14px);
	padding: 0 26px;
	line-height: var(--vscode-markdown-line-height, 22px);
	word-wrap: break-word;
}

#code-csp-warning {
	position: fixed;
	top: 0;
	right: 0;
	color: white;
	margin: 16px;
	text-align: center;
	font-size: 12px;
	font-family: sans-serif;
	background-color:#444444;
	cursor: pointer;
	padding: 6px;
	box-shadow: 1px 1px 1px rgba(0,0,0,.25);
}

#code-csp-warning:hover {
	text-decoration: none;
	background-color:#007acc;
	box-shadow: 2px 2px 2px rgba(0,0,0,.25);
}

body.scrollBeyondLastLine {
	margin-bottom: calc(100vh - 22px);
}

body.showEditorSelection .code-line {
	position: relative;
}

body.showEditorSelection .code-active-line:before,
body.showEditorSelection .code-line:hover:before {
	content: "";
	display: block;
	position: absolute;
	top: 0;
	left: -12px;
	height: 100%;
}

body.showEditorSelection li.code-active-line:before,
body.showEditorSelection li.code-line:hover:before {
	left: -30px;
}

.vscode-light.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(0, 0, 0, 0.15);
}

.vscode-light.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(0, 0, 0, 0.40);
}

.vscode-light.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-dark.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 255, 255, 0.4);
}

.vscode-dark.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 255, 255, 0.60);
}

.vscode-dark.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-high-contrast.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 160, 0, 0.7);
}

.vscode-high-contrast.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 160, 0, 1);
}

.vscode-high-contrast.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

img {
	max-width: 100%;
	max-height: 100%;
}

a {
	text-decoration: none;
}

a:hover {
	text-decoration: underline;
}

a:focus,
input:focus,
select:focus,
textarea:focus {
	outline: 1px solid -webkit-focus-ring-color;
	outline-offset: -1px;
}

hr {
	border: 0;
	height: 2px;
	border-bottom: 2px solid;
}

h1 {
	padding-bottom: 0.3em;
	line-height: 1.2;
	border-bottom-width: 1px;
	border-bottom-style: solid;
}

h1, h2, h3 {
	font-weight: normal;
}

table {
	border-collapse: collapse;
}

table > thead > tr > th {
	text-align: left;
	border-bottom: 1px solid;
}

table > thead > tr > th,
table > thead > tr > td,
table > tbody > tr > th,
table > tbody > tr > td {
	padding: 5px 10px;
}

table > tbody > tr + tr > td {
	border-top: 1px solid;
}

blockquote {
	margin: 0 7px 0 5px;
	padding: 0 16px 0 10px;
	border-left-width: 5px;
	border-left-style: solid;
}

code {
	font-family: Menlo, Monaco, Consolas, "Droid Sans Mono", "Courier New", monospace, "Droid Sans Fallback";
	font-size: 1em;
	line-height: 1.357em;
}

body.wordWrap pre {
	white-space: pre-wrap;
}

pre:not(.hljs),
pre.hljs code > div {
	padding: 16px;
	border-radius: 3px;
	overflow: auto;
}

pre code {
	color: var(--vscode-editor-foreground);
	tab-size: 4;
}

/** Theming */

.vscode-light pre {
	background-color: rgba(220, 220, 220, 0.4);
}

.vscode-dark pre {
	background-color: rgba(10, 10, 10, 0.4);
}

.vscode-high-contrast pre {
	background-color: rgb(0, 0, 0);
}

.vscode-high-contrast h1 {
	border-color: rgb(0, 0, 0);
}

.vscode-light table > thead > tr > th {
	border-color: rgba(0, 0, 0, 0.69);
}

.vscode-dark table > thead > tr > th {
	border-color: rgba(255, 255, 255, 0.69);
}

.vscode-light h1,
.vscode-light hr,
.vscode-light table > tbody > tr + tr > td {
	border-color: rgba(0, 0, 0, 0.18);
}

.vscode-dark h1,
.vscode-dark hr,
.vscode-dark table > tbody > tr + tr > td {
	border-color: rgba(255, 255, 255, 0.18);
}

</style>

<style>
/* Tomorrow Theme */
/* http://jmblog.github.com/color-themes-for-google-code-highlightjs */
/* Original theme - https://github.com/chriskempson/tomorrow-theme */

/* Tomorrow Comment */
.hljs-comment,
.hljs-quote {
	color: #8e908c;
}

/* Tomorrow Red */
.hljs-variable,
.hljs-template-variable,
.hljs-tag,
.hljs-name,
.hljs-selector-id,
.hljs-selector-class,
.hljs-regexp,
.hljs-deletion {
	color: #c82829;
}

/* Tomorrow Orange */
.hljs-number,
.hljs-built_in,
.hljs-builtin-name,
.hljs-literal,
.hljs-type,
.hljs-params,
.hljs-meta,
.hljs-link {
	color: #f5871f;
}

/* Tomorrow Yellow */
.hljs-attribute {
	color: #eab700;
}

/* Tomorrow Green */
.hljs-string,
.hljs-symbol,
.hljs-bullet,
.hljs-addition {
	color: #718c00;
}

/* Tomorrow Blue */
.hljs-title,
.hljs-section {
	color: #4271ae;
}

/* Tomorrow Purple */
.hljs-keyword,
.hljs-selector-tag {
	color: #8959a8;
}

.hljs {
	display: block;
	overflow-x: auto;
	color: #4d4d4c;
	padding: 0.5em;
}

.hljs-emphasis {
	font-style: italic;
}

.hljs-strong {
	font-weight: bold;
}
</style>

<style>
/*
 * Markdown PDF CSS
 */

 body {
	font-family: -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif, "Meiryo";
	padding: 0 12px;
}

pre {
	background-color: #f8f8f8;
	border: 1px solid #cccccc;
	border-radius: 3px;
	overflow-x: auto;
	white-space: pre-wrap;
	overflow-wrap: break-word;
}

pre:not(.hljs) {
	padding: 23px;
	line-height: 19px;
}

blockquote {
	background: rgba(127, 127, 127, 0.1);
	border-color: rgba(0, 122, 204, 0.5);
}

.emoji {
	height: 1.4em;
}

code {
	font-size: 14px;
	line-height: 19px;
}

/* for inline code */
:not(pre):not(.hljs) > code {
	color: #C9AE75; /* Change the old color so it seems less like an error */
	font-size: inherit;
}

/* Page Break : use <div class="page"/> to insert page break
-------------------------------------------------------- */
.page {
	page-break-after: always;
}

</style>

<script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
</head>
<body>
  <script>
    mermaid.initialize({
      startOnLoad: true,
      theme: document.body.classList.contains('vscode-dark') || document.body.classList.contains('vscode-high-contrast')
          ? 'dark'
          : 'default'
    });
  </script>
<h1 id="%E4%BB%8B%E7%BB%8D%E6%99%BA%E8%83%BD%E5%90%88%E7%BA%A6">介绍智能合约</h1>
<h2 id="%E4%B8%80%E4%B8%AA%E7%AE%80%E5%8D%95%E7%9A%84%E6%99%BA%E8%83%BD%E5%90%88%E7%BA%A6span-id%22easycontract%22span">一个简单的智能合约<span id="easy_contract"></span></h2>
<p>我们从一个基础例子开始。这个例子为变量赋值，并将其公开以供其他合约访问。如果你现在还不能理解所有内容也没关系，我们会后面会做更详细的讲解。</p>
<h3 id="%E5%AD%98%E5%82%A8%E7%9A%84%E4%BE%8B%E5%AD%90span-id%22storeexample%22span">存储的例子<span id="store_example"></span></h3>
<pre class="hljs"><code><div>
<span class="hljs-comment">// SPDX-License-Identifier: GPL-3.0</span>
pragma solidity &gt;=<span class="hljs-number">0.4</span><span class="hljs-number">.16</span> &lt;<span class="hljs-number">0.9</span><span class="hljs-number">.0</span>;

contract SimpleStorage {
    uint storedData;

    <span class="hljs-function">function <span class="hljs-title">set</span><span class="hljs-params">(uint x)</span> <span class="hljs-keyword">public</span> </span>{
        storedData = x;
    }

    <span class="hljs-function">function <span class="hljs-title">get</span><span class="hljs-params">()</span> <span class="hljs-keyword">public</span> view <span class="hljs-title">returns</span> <span class="hljs-params">(uint)</span> </span>{
        <span class="hljs-keyword">return</span> storedData;
    }
}

</div></code></pre>
<p>上面代码第一行，告诉我们这段代码在GPL version 3.0协议下获得许可。一个可以被编译器识别的许可说明符在源代码发布的设置中非常重要。您可以从<a href="https://spdx.org/licenses/">这里</a>查看这些协议内容。</p>
<p>下面一行的意思是说这段源代码用Solidity 0.4.16版本或更高的版本编写的，但最高不超过0.9.0版本。这行代码确保这个合约不会被更高版本的编译器所编译，因为这些编译器的行为可能有所不同。<a href="./Pragma.md">Pragmas</a>是告诉编译器怎么样去处理源代码的常用指令（比如：Pragma once）。</p>
<p>Solidity实质意义的合约是一个保存在以太坊区块链上的特定地址代码（功能）和数据（状态）的集合。
<kbd style="color:red">unit storedData;</kbd> 这一行，声明了一个类型是uint(256位无符号整形)叫<kbd style="color:red"> storedData</kbd>状态变量。你可以认为它是一个数据库里插槽。你可以通过调用管理数据的代码来查询和变更它。在这个例子中，智能合约定义了<kbd style="color:red">set</kbd>和<kbd style="color:red">get</kbd>两个函数，用来修改或检索这个变量的值。</p>
<p>访问当前合约的个成员(如状态变量)的时候，通常添加<kbd style="color:red">this.</kbd>前缀，你只需要直接通过成员的名字访问它。与其他一些语言不同，忽略它不仅是一个样式问题，它会导致成员访问方式完全不同，稍后会详细介绍。</p>
<p>除了(由于以太坊构建的基础设施)允许任何人存储世界上任何人都可以访问的单个数字之外，这份智能合约还没有做太多的事情，没有任何(可行的)方式可以阻止你发布这个数字。任何人可以调用<kbd style="color:red">set</kbd>方法，用不同的值覆盖你的数字，但是这个数字仍然存在区块链的历史数据中。稍后，你可以看到如何增加访问限制，以保证只有你可以修改这个数字。</p>
<div style="background:#e9b684;color:#fff;padding:5px;font-weight:600;">
&#x26A0;&#xFE0F; Waring
</div>
<div style="background:#fdeecf;color:#404040;padding:10px">
&#x5C0F;&#x5FC3;&#x4F7F;&#x7528;Unicode&#x6587;&#x672C;&#xFF0C;&#x90A3;&#x4E9B;&#x770B;&#x7740;&#x50CF;(&#x751A;&#x81F3;&#x662F;&#x76F8;&#x540C;&#x7684;)&#x5B57;&#x7B26;&#xFF0C;&#x53EF;&#x80FD;&#x6709;&#x4E0D;&#x540C;&#x7684;&#x7801;&#x4F4D;&#xFF0C;&#x56E0;&#x6B64;&#x88AB;&#x7F16;&#x7801;&#x4E3A;&#x4E0D;&#x540C;&#x7684;&#x81EA;&#x5DF1;&#x9635;&#x5217;&#x3002;
</div>
<br>
<div style="background:#76afdb;color:#fff;padding:5px;font-weight:600">
&#x26A0;&#xFE0F; Note
</div>
<div style="background:#e9f2fa;color:#404040;padding:10px">
&#x6240;&#x6709;&#x7684;&#x662F;&#x8BC6;&#x6807;&#x8BC6;&#x7B26;&#xFF08;&#x5408;&#x7EA6;&#x540D;&#x79F0;&#xFF0C;&#x51FD;&#x6570;&#x540D;&#xFF0C;&#x53D8;&#x91CF;&#x540D;&#xFF09;&#x90FD;&#x88AB;&#x5B58;&#x50A8;&#x4E3A;ASCII&#x5B57;&#x7B26;&#x96C6;&#x3002;&#x53EF;&#x4EE5;&#x5C06;UTF-8&#x7F16;&#x7801;&#x7684;&#x6570;&#x636E;&#x5B58;&#x50A8;&#x5728;&#x5B57;&#x7B26;&#x4E32;&#x53D8;&#x91CF;&#x4E2D;&#x3002;
</div>
<br>
<h3 id="%E5%AD%90%E8%B4%A7%E5%B8%81%E7%A4%BA%E4%BE%8B">子货币示例</h3>
<p>下面这个合约实现了最简单的加密货币形式。这个合约只允许合约的创建人创建新货币(可能用不同的发行方案)。任何人可以相互发送货币不需要使用用户名和密码注册。你需要的全部只是一对以太坊密钥对。</p>
<pre class="hljs"><code><div>
<span class="hljs-comment">// SPDX-License-Identifier: GPL-3.0</span>
pragma solidity ^<span class="hljs-number">0.8</span><span class="hljs-number">.4</span>;

contract Coin {
    <span class="hljs-comment">// The keyword "public" makes variables</span>
    <span class="hljs-comment">// accessible from other contracts</span>
    address <span class="hljs-keyword">public</span> minter;
    mapping (address =&gt; uint) <span class="hljs-keyword">public</span> balances;

    <span class="hljs-comment">// Events allow clients to react to specific</span>
    <span class="hljs-comment">// contract changes you declare</span>
    <span class="hljs-function">event <span class="hljs-title">Sent</span><span class="hljs-params">(address from, address to, uint amount)</span></span>;

    <span class="hljs-comment">// Constructor code is only run when the contract</span>
    <span class="hljs-comment">// is created</span>
    constructor() {
        minter = msg.sender;
    }

    <span class="hljs-comment">// Sends an amount of newly created coins to an address</span>
    <span class="hljs-comment">// Can only be called by the contract creator</span>
    <span class="hljs-function">function <span class="hljs-title">mint</span><span class="hljs-params">(address receiver, uint amount)</span> <span class="hljs-keyword">public</span> </span>{
        require(msg.sender == minter);
        balances[receiver] += amount;
    }

    <span class="hljs-comment">// Errors allow you to provide information about</span>
    <span class="hljs-comment">// why an operation failed. They are returned</span>
    <span class="hljs-comment">// to the caller of the function.</span>
    <span class="hljs-function">error <span class="hljs-title">InsufficientBalance</span><span class="hljs-params">(uint requested, uint <span class="hljs-built_in">available</span>)</span></span>;

    <span class="hljs-comment">// Sends an amount of existing coins</span>
    <span class="hljs-comment">// from any caller to an address</span>
    <span class="hljs-function">function <span class="hljs-title">send</span><span class="hljs-params">(address receiver, uint amount)</span> <span class="hljs-keyword">public</span> </span>{
        <span class="hljs-keyword">if</span> (amount &gt; balances[msg.sender])
            <span class="hljs-function">revert <span class="hljs-title">InsufficientBalance</span><span class="hljs-params">({
                requested: amount,
                <span class="hljs-built_in">available</span>: balances[msg.sender]
            })</span></span>;

        balances[msg.sender] -= amount;
        balances[receiver] += amount;
        <span class="hljs-function">emit <span class="hljs-title">Sent</span><span class="hljs-params">(msg.sender, receiver, amount)</span></span>;
    }
}

</div></code></pre>
<p>这个合约介绍一些新概念，让我们一个一个的了解它们。</p>
<p><code>address public minter</code> 这行</p>

</body>
</html>
